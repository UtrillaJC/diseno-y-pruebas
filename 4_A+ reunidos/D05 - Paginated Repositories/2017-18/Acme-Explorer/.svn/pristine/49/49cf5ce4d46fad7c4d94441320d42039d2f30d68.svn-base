<%-- edit.jsp de Application --%>

<%@page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>

<%@taglib prefix="jstl" uri="http://java.sun.com/jsp/jstl/core"%>
<%@taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@taglib prefix="tiles" uri="http://tiles.apache.org/tags-tiles"%>
<%@taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@taglib prefix="security"	uri="http://www.springframework.org/security/tags"%>
<%@taglib prefix="display" uri="http://displaytag.sf.net"%>

<form:form action="${requestURI}" modelAttribute="application">
	
	<!-- Atributos ocultos -->
	<form:hidden path="id"/>
	<form:hidden path="version"/>
	
	<!-- Atributos ocultas de las relaciones -->
	<form:hidden path="explorer"/>
	
	
	<!-- Aquí tiene que haber un if -->
	<spring:message var="applicationTrip" code="application.trip"/>
	<b><form:label path="trip" title="${applicationTrip}"/>:&nbsp;</b>
	<form:select path="trip">
		<form:option label="----" value="0"/>
		<form:options items="${trips}" itemLabel="ticker" itemValue="id"/>
	</form:select>
	<form:errors path="trip" cssClass="error"/>
	<br/>
	
	<spring:message var="applicationComments" code="application.comments"/>
	<b><form:label path="comments" title="${applicationComments}"/>:&nbsp;</b>
	<form:textarea path="comments"/>
	<form:errors path="comments" cssClass="error"/>
	<a href="application/comment.do"><jstl:out value="${applicationCreate}"/></a>   <!-- TODO: ¿Cómo podemos implementar esta funcionalidad? -->
	<br/>
	
	
	<spring:message var="applicationStatus" code="application.status"/>
	<b><form:label path="status" title="${applicationStatus}"/>:&nbsp;</b>
	<security:authorize access="hasRole('MANAGER')">
		<form:select path="status">
			<form:option label="----" value="0"/>
			<form:options items="${status}" itemLabel="status" itemValue="id"/> <!-- Esto no se como ponerlo -->
		</form:select>
	</security:authorize>
	<security:authorize access="hasRole('EXPLORER')">
		<form:select path="status" disabled="true">
			<form:option label="----" value="0"/>
			<form:options items="${status}" itemLabel="status" itemValue="id"/> <!-- Esto no se como ponerlo -->
		</form:select>
	</security:authorize>
	<form:errors path="status" cssClass="error"/>
	<br/>
	
	<!-- Tarjeta de crédito -->
	<fieldset>
		<legend><spring:message code="application.creditCard"/></legend>
		
		<spring:message var="applicationHolder" code="application.holder"/>
		<b><form:label path="creditCard.holder" title="${applicationHolder}"/>:&nbsp;</b>
		<form:input path="creditCard.holder"/>
		<form:errors path="creditCard.holder" cssClass="error"/>
		<br/>
		
		<spring:message var="applicationBrand" code="application.brand"/>
		<b> <form:label path="creditCard.brand" title="${applicationBrand}"/>:&nbsp;</b>
		<form:input path="creditCard.brand"/>
		<form:errors path="creditCard.brand" cssClass="error"/>
		<br/>
		
		<spring:message var="applicationNumber" code="application.number"/>
		<b> <form:label path="creditCard.number" title="${applicationNumber}"/>:&nbsp;</b>
		<form:input path="creditCard.number"/>
		<form:errors path="creditCard.number" cssClass="error"/>
		<br/>
		
<%-- 		<spring:message var="applicationExpiration" code="application.expiration"/> --%>
<%-- 		<b> <form:label path="expiration" title="${applicationExpiration}:&nbsp;"/> </b> --%>
<%-- 		<form:input path="expirationMonth" placeholder="1-12"/> - <form:input path="expirationYear" placeholder="XXXX"/>  --%>
<%-- 		<form:errors path="expirationMonth" cssClass="error"/> <form:errors path="expirationMonth" cssClass="error"/>  --%>
<!-- 		<br/> -->
		
		<spring:message var="applicationCvv" code="application.cvv"/>
		<b> <form:label path="creditCard.cvv" title="${applicationCvv}"/>:&nbsp;</b>
		<form:input path="creditCard.cvv"/>
		<form:errors path="creditCard.cvv" cssClass="error"/>
		<br/>
	</fieldset>
	
	<spring:message var="applicationSave" code="application.save"/>
	<input type="submit" name="save" value="${applicationSave}" />
	
	<spring:message var="applicationCancel" code="application.cancel"/>
	<!-- TODO: ¿Como distinguir el usuario para introducirlo en javascript? -->
	<input type="button" name="cancel" value="<spring:message code="${applicationCancel}" />" onclick="javascript: relativeRedir('application/list.do');" />
</form:form>