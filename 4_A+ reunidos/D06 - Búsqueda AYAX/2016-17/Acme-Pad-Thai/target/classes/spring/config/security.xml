<?xml version="1.0" encoding="UTF-8"?>

<!-- 
 * security.xml
 *
 * Copyright (C) 2016 Universidad de Sevilla
 * 
 * The use of this project is hereby constrained to the conditions of the 
 * TDG Licence, a copy of which you may download from 
 * http://www.tdg-seville.info/License.html
 -->

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:security="http://www.springframework.org/schema/security"	
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd		
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd
    ">

	<!-- Security infrastructure -->

	<bean id="loginService" class="security.LoginService" />

	<bean id="passwordEncoder"
		class="org.springframework.security.authentication.encoding.Md5PasswordEncoder" />

	<!-- Access control -->

	<security:http auto-config="true" use-expressions="true">
		<security:intercept-url pattern="/" access="permitAll" /> 

		<security:intercept-url pattern="/favicon.ico" access="permitAll" /> 
		<security:intercept-url pattern="/images/**" access="permitAll" /> 
		<security:intercept-url pattern="/scripts/**" access="permitAll" /> 
		<security:intercept-url pattern="/styles/**" access="permitAll" /> 

		<security:intercept-url pattern="/views/misc/index.jsp" access="permitAll" /> 

		<security:intercept-url pattern="/security/login.do" access="permitAll" />
		<security:intercept-url pattern="/security/loginFailure.do" access="permitAll" /> 
		
		<security:intercept-url pattern="/security/registerUser.do" access="permitAll" /> 
		<security:intercept-url pattern="/security/registerNutritionist.do" access="permitAll" /> 
		<security:intercept-url pattern="/security/registerSponsor.do" access="permitAll" />
		
		<security:intercept-url pattern="/welcome/index.do" access="permitAll" /> 
		
		
		<security:intercept-url pattern="/recipe/searchForm.do" access="permitAll" />	
		<security:intercept-url pattern="/recipe/search.do" access="permitAll" /> 
		<security:intercept-url pattern="/recipe/showRecipe.do" access="permitAll" /> 
		<security:intercept-url pattern="/recipe/list.do" access="permitAll" />
		<security:intercept-url pattern="/recipe/listByUser.do" access="permitAll" />
		<security:intercept-url pattern="/recipe/listQualifyByContest.do" access="permitAll" /> 
		<security:intercept-url pattern="/recipe/listWinnersContest.do" access="permitAll" />
		
		<security:intercept-url pattern="/user/searchForm.do" access="permitAll" /> 
		<security:intercept-url pattern="/user/search.do" access="permitAll" /> 
		<security:intercept-url pattern="/user/list.do" access="permitAll" /> 
		<security:intercept-url pattern="/user/showUser.do" access="permitAll" /> 
		
		<security:intercept-url pattern="/masterClass/list.do" access="permitAll" />
		
		<security:intercept-url pattern="/banner/listBannerStarredCampaign.do" access="permitAll" />
		

		<security:intercept-url pattern="/contest/list.do" access="permitAll" />

		
		
		
		<security:intercept-url pattern="/actor/editProfile.do" access="isAuthenticated()" />
		<security:intercept-url pattern="/actor/editSocialIdentity.do" access="isAuthenticated()" />

		<security:intercept-url pattern="/mailbox/actor/list.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/mailbox/actor/list2.do" access="isAuthenticated()" /> 
	
		<security:intercept-url pattern="/message/actor/showMessage.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/message/actor/create.do" access="isAuthenticated()" />
		<security:intercept-url pattern="/message/actor/edit.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/message/actor/moveTo.do" access="isAuthenticated()" /> 
	
		<security:intercept-url pattern="/folder/actor/list.do" access="isAuthenticated()" />
		<security:intercept-url pattern="/folder/actor/create.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/folder/actor/edit.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/folder/actor/childrenList.do" access="isAuthenticated()" />
		<security:intercept-url pattern="/folder/actor/createChild.do" access="isAuthenticated()" /> 
		<security:intercept-url pattern="/folder/actor/moveTo.do" access="isAuthenticated()" /> 
		
		<security:intercept-url pattern="/learningMaterial/list.do" access="isAuthenticated()" /> 		
		
		
		
		
		<security:intercept-url pattern="/comment/**" access="hasRole('NUTRITIONIST') || hasRole('USER')" />
		
		<security:intercept-url pattern="/person/list-follow.do" access="hasRole('USER') || hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/person/list-unfollow.do" access="hasRole('USER') || hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/person/follow.do" access="hasRole('USER') || hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/person/unfollow.do" access="hasRole('USER') || hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/person/followNutritionist.do" access="hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/person/unfollowNutritionist.do" access="hasRole('NUTRITIONIST')" />
		


		<security:intercept-url pattern="/recipe/list-without-tastes.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" /> 
		<security:intercept-url pattern="/recipe/list-likes.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" /> 
		<security:intercept-url pattern="/recipe/list-dislikes.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" /> 
		<security:intercept-url pattern="/recipe/likes.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" /> 
		<security:intercept-url pattern="/recipe/dislikes.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" />
		<security:intercept-url pattern="/recipe/list-recipes-follow.do"  access="hasRole('NUTRITIONIST') || hasRole('USER')" /> 
	
	
	
		
		<security:intercept-url pattern="/administrator/editProfile.do" access="hasRole('ADMINISTRATOR')" /> 
		
		<security:intercept-url pattern="/socialIdentity/administrator/editSocialIdentity.do" access="hasRole('ADMINISTRATOR')" />  
		
		<security:intercept-url pattern="/security/administrator/registerCook.do" access="hasRole('ADMINISTRATOR')"/>  
		
		<security:intercept-url pattern="/contest/administrator/create.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/contest/administrator/edit.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/contest/administrator/contestsFinished.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/contest/administrator/execute.do" access="hasRole('ADMINISTRATOR')" />
		
		<security:intercept-url pattern="/category/administrator/list.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/category/administrator/create.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/category/administrator/edit.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/category/administrator/list-addCategoryParent.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/category/administrator/addCategoryParent.do" access="hasRole('ADMINISTRATOR')" />
		
		<security:intercept-url pattern="/masterClass/administrator/list-promoted.do" access="hasRole('ADMINISTRATOR')" /> 
  		<security:intercept-url pattern="/masterClass/administrator/list-demoted.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/masterClass/administrator/promote.do" access="hasRole('ADMINISTRATOR')" /> 
  		<security:intercept-url pattern="/masterClass/administrator/demote.do" access="hasRole('ADMINISTRATOR')" /> 
  		
  		<security:intercept-url pattern="/spamTerm/administrator/showSpamTerm.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/spamTerm/administrator/edit.do" access="hasRole('ADMINISTRATOR')" /> 
  		
		<security:intercept-url pattern="/administrator/dashboardRecipe.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardUser.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardBill.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardContest.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardMasterClass.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardSponsor.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/administrator/dashboardStepToCook.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardIngredient.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardLearningMaterial.do" access="hasRole('ADMINISTRATOR')" /> 
		<security:intercept-url pattern="/administrator/dashboardCampaign.do" access="hasRole('ADMINISTRATOR')" /> 	
		
  		<security:intercept-url pattern="/campaign/administrator/list.do" access="hasRole('ADMINISTRATOR')" />
  		<security:intercept-url pattern="/campaign/administrator/generateMonthlyBill.do" access="hasRole('ADMINISTRATOR')" />
		
		<security:intercept-url pattern="/bill/administrator/list.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/bill/administrator/sendMessage.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/bill/administrator/showBill.do" access="hasRole('ADMINISTRATOR')" />
		
		<security:intercept-url pattern="/fee/administrator/edit.do" access="hasRole('ADMINISTRATOR')" />
		<security:intercept-url pattern="/fee/administrator/showFee.do" access="hasRole('ADMINISTRATOR')"/>  
		
		
		
		  
		<security:intercept-url pattern="/user/editProfile.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/socialIdentity/user/editSocialIdentity.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/recipe/user/list.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/showRecipe.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/edit.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/create.do" access="hasRole('USER')" />	
		<security:intercept-url pattern="/recipe/user/listCategory.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/addCategory.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/addIngredientLine.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/addIngredient.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/recipe/user/addStepToCook.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/ingredientLine/user/addIngredientLine.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/masterClass/user/list-registered.do" access="hasRole('USER')" />	
		<security:intercept-url pattern="/masterClass/user/list-not-registered.do" access="hasRole('USER')" />	
		<security:intercept-url pattern="/masterClass/user/register.do" access="hasRole('USER')" />	
		<security:intercept-url pattern="/masterClass/user/unregister.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/learningMaterial/user/list.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/learningMaterial/user/showLearningMaterial.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/category/user/add.do" access="hasRole('USER')" />
		
		<security:intercept-url pattern="/contest/user/list.do" access="hasRole('USER')" />			
	
		<security:intercept-url pattern="/registration/user/register.do" access="hasRole('USER')" />
		<security:intercept-url pattern="/registration/user/list.do" access="hasRole('USER')" />
		
		
		
		  
		<security:intercept-url pattern="/nutritionist/editProfile.do" access="hasRole('NUTRITIONIST')" />
		
		<security:intercept-url pattern="/socialIdentity/nutritionist/editSocialIdentity.do" access="hasRole('NUTRITIONIST')" />
		
		<security:intercept-url pattern="/endorser/nutritionist/list.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/endorser/nutritionist/edit.do" access="hasRole('NUTRITIONIST')" /> 	
		<security:intercept-url pattern="/endorser/nutritionist/create.do" access="hasRole('NUTRITIONIST')" />   
		<security:intercept-url pattern="/endorser/nutritionist/add.do" access="hasRole('NUTRITIONIST')" /> 
	
		<security:intercept-url pattern="/curriculum/nutritionist/list.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/curriculum/nutritionist/edit.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/curriculum/nutritionist/create.do" access="hasRole('NUTRITIONIST')" />   
		<security:intercept-url pattern="/curriculum/nutritionist/showCurriculum.do" access="hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/curriculum/nutritionist/addEndorser.do" access="hasRole('NUTRITIONIST')" />
	
		<security:intercept-url pattern="/property/nutritionist/list.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/property/nutritionist/edit.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/property/nutritionist/create.do" access="hasRole('NUTRITIONIST')" />  
		<security:intercept-url pattern="/property/nutritionist/add.do" access="hasRole('NUTRITIONIST')" /> 
	
		<security:intercept-url pattern="/ingredient/nutritionist/list.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/ingredient/nutritionist/edit.do" access="hasRole('NUTRITIONIST')" /> 
		<security:intercept-url pattern="/ingredient/nutritionist/create.do" access="hasRole('NUTRITIONIST')" /> 	
		<security:intercept-url pattern="/ingredient/nutritionist/showIngredient.do" access="hasRole('NUTRITIONIST')" />
		<security:intercept-url pattern="/ingredient/nutritionist/addProperty.do" access="hasRole('NUTRITIONIST')" />
		 
		 
		 
  
		<security:intercept-url pattern="/cook/editProfile.do" access="hasRole('COOK')" />  
		
 		<security:intercept-url pattern="/socialIdentity/cook/editSocialIdentity.do" access="hasRole('COOK')" />
 		
 		<security:intercept-url pattern="/masterClass/cook/list.do" access="hasRole('COOK')" />
		<security:intercept-url pattern="/masterClass/cook/create.do" access="hasRole('COOK')" />
		<security:intercept-url pattern="/masterClass/cook/edit.do" access="hasRole('COOK')" />
 		
 		<security:intercept-url pattern="/learningMaterial/editText.do" access="hasRole('COOK')" />
	 	<security:intercept-url pattern="/learningMaterial/editPresentation.do" access="hasRole('COOK')" />
	 	<security:intercept-url pattern="/learningMaterial/editVideo.do" access="hasRole('COOK')" />
	 	
		<security:intercept-url pattern="/text/cook/edit.do" access="hasRole('COOK')" />
		<security:intercept-url pattern="/presentation/cook/edit.do" access="hasRole('COOK')" />
		<security:intercept-url pattern="/video/cook/edit.do" access="hasRole('COOK')" />
 		
 		
 		
		
		<security:intercept-url pattern="/socialIdentity/sponsor/editSocialIdentity.do" access="hasRole('SPONSOR')" />
		
		<security:intercept-url pattern="/sponsor/editProfile.do" access="hasRole('SPONSOR')" /> 
		
		<security:intercept-url pattern="/bill/sponsor/list-paid.do" access="hasRole('SPONSOR')" />
		<security:intercept-url pattern="/bill/sponsor/list-unpaid.do" access="hasRole('SPONSOR')" />
		<security:intercept-url pattern="/bill/sponsor/pay.do" access="hasRole('SPONSOR')" />
		
		<security:intercept-url pattern="/creditCard/sponsor/view.do" access="hasRole('SPONSOR')" />
		<security:intercept-url pattern="/creditCard/sponsor/edit.do" access="hasRole('SPONSOR')" />

	    <security:intercept-url pattern="/campaign/sponsor/list.do" access="hasRole('SPONSOR')" /> 
  		<security:intercept-url pattern="/campaign/sponsor/edit.do" access="hasRole('SPONSOR')" /> 
  		<security:intercept-url pattern="/campaign/sponsor/create.do" access="hasRole('SPONSOR')" /> 
    
    	<security:intercept-url pattern="/banner/sponsor/list.do" access="hasRole('SPONSOR')" />
   		<security:intercept-url pattern="/banner/sponsor/create.do" access="hasRole('SPONSOR')" /> 
		<security:intercept-url pattern="/banner/sponsor/edit.do" access="hasRole('SPONSOR')" /> 		


		

		<security:intercept-url pattern="/**" access="hasRole('NONE')" />

		<security:form-login 
			login-page="/security/login.do"
			password-parameter="password" 
			username-parameter="username"
			authentication-failure-url="/security/loginFailure.do" />

		<security:logout 
			logout-success-url="/" 
			invalidate-session="true" />
	</security:http>

</beans>